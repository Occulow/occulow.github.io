<!DOCTYPE html>
<html>
  <head>
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!--Import materialize.css-->
    <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>

    <link type="text/css" rel="stylesheet" href="css/main.css"  media="screen,projection"/>

    <title>Occulow</title>

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  </head>

  <body>
    <!-- Normal nav -->
    <div class="navbar-fixed no-height">
      <nav>
        <div class="nav-wrapper">
          <a href="#top" class="brand-logo nav-logo">Occulow</a>
          <a href="#" data-activates="mobile-nav" class="button-collapse"><i class="material-icons">menu</i></a>
          <ul class="right hide-on-med-and-down">
            <li><a href="#concept">Concept and Motivation</a></li>
            <li><a href="#competition">Competition</a></li>
            <li><a href="#requirements">Requirements</a></li>
            <li><a href="#specifications">Technical Specifications</a></li>
            <li><a href="#use-cases">Use Cases</a></li>
            <li><a href="#architecture">Architecture</a></li>
            <li><a href="#interactions">Interactions</a></li>
            <li><a href="#progress">Progress</a></li>
            <li><a href="#about">About Us</a></li>
          </ul>
        </div>
      </nav>
    </div>
    <!-- Mobile nav -->
    <ul class="side-nav" id="mobile-nav">
      <li><a href="#concept">Concept and Motivation</a></li>
      <li><a href="#competition">Competition</a></li>
      <li><a href="#requirements">Requirements</a></li>
      <li><a href="#specifications">Technical Specifications</a></li>
      <li><a href="#use-cases">Use Cases</a></li>
      <li><a href="#architecture">Architecture</a></li>
      <li><a href="#interactions">Interactions</a></li>
      <li><a href="#progress">Progress</a></li>
      <li><a href="#about">About Us</a></li>
    </ul>
    <!-- Image header and title -->
    <div id="top" class="image-header scrollspy">
      <div class="image-header-title">Occulow</div>
      <div class="image-header-subtitle"><span class="">Low Power, City-Wide Occupancy Sensing</span></div>
    </div>
    <!-- Concept/Motivation -->
    <div class="section grey lighten-4">
      <div class="container">
        <div class="row">
          <div class="col s12">
            <div id="concept" class="center-align scrollspy">
              <h1>Concept</h1>
              <p class="flow-text">
                This project will use a small doorframe-mounted sensor to count the number of people entering
                or exiting a room threshold with a high degree of accuracy. The device will operate on battery
                power for more than a year, processing data from a grid-array of infrared sensors and transmitting
                it for display to our cloud service through the LoRa low-power wide area network.
              </p>
            </div>
          </div>
        </div>
        <div class="divider"></div>
        <div class="row">
          <div class="col s12">
            <div class="center-align">
              <h1>Motivation</h1>
              <p class="flow-text">
                Most modern occupancy sensing systems require expensive infrastructure such as connected power or local WiFi. It is prohibitively expensive to route power to arbitrary points in a building, so battery-powered solutions are desirable.
              </p>
              <p class="flow-text">
                With our device, occupancy in a building or room could be monitored for more than a year on a D-cell batteries. Additionally, no local WiFi infrastructure will be necessary as the sensor system transmits data to a user-facing website interface using the LoRaWAN protocol.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Competition -->
    <div class="section grey lighten-2">
      <div class="container">
        <div class="row">
          <div class="col s12">
            <div id="competition" class="center-align scrollspy">
              <h1>Competitive Analysis</h1>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col s12 m4 center-align">
            <img class="promo-image" src="images/countwise.png">
            <a class="promo-caption" href="http://www.countwise.com/product/door-counter/">CountWise</a>
            <p class="flow-text">
              CountWise systems uses video and image processing technology to count people moving through a space. While this
              is more general than our approach and can be applied in a greater variety of locations, it is much more
              power-intensive.
            </p>
          </div>
          <div class="col s12 m4 center-align">
            <img class="promo-image" src="images/irisys-gazelle.png">
            <a class="promo-caption" href="http://www.irisys.net/products-gazelle2-people-counter">Irisys</a>
            <p class="flow-text">
                Irisys has sophisticated people-counting products, capable of covering large door spaces. Unlike our product, though,
                it requires both power and ethernet connectivity.
            </p>
          </div>
          <div class="col s12 m4 center-align">
            <img class="promo-image" src="images/blankspace.jpg">
            <a class="promo-caption" href="https://www.ece.cmu.edu/~ece549/spring16/team17/website/Team17/Team17/team17.html">Rita</a>
            <p class="flow-text">
              Rita was another capstone project built last year. They used accelerometers placed in chairs that took readings and
              transmitted data every 30 minutes to detect whether seats were occupied. We intend our system to provide updates at a
              faster rate as well as use a much smaller number of devices to monitor a space.
            </p>
          </div>
        </div>
      </div>
    </div>
    <!-- Requirements -->
    <div class="section grey lighten-4">
      <div class="container">
        <div class="row">
          <div class="col s12">
            <div id="requirements" class="center-align scrollspy">
              <h1>Requirements</h1>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col s12 m6">
            <h2 class="center-align">Functional</h2>
            <ul class="collection">
              <li class="collection-item avatar valign-wrapper">
                  <i class="material-icons circle green valign">perm_identity</i>
                  <span class="title">
                    Build a device that is capable of sensing the occupancy of a room by placing it at its entrance.
                  </span>
              </li>
              <li class="collection-item avatar valign-wrapper">
                  <i class="material-icons circle green valign">power_settings_new</i>
                  <span class="title">
                    The device should be battery-powered, running on D-cell or AA size batteries.
                  </span>
              </li>
              <li class="collection-item avatar valign-wrapper">
                  <i class="material-icons circle green valign">settings_input_antenna</i>
                  <span class="title">
                    The device should be able to transmit that information over a network and communicate the occupancy of the room to a central server.
                  </span>
              </li>
              <li class="collection-item avatar valign-wrapper">
                  <i class="material-icons circle green valign">web</i>
                  <span class="title">
                    The occupancy information should be displayed through a front-end service such as a web interface.
                  </span>
              </li>
            </ul>
          </div>
          <div class="col s12 m6">
            <h2 class="center-align">Non-Functional</h2>
            <ul class="collection">
              <li class="collection-item avatar valign-wrapper">
                  <i class="material-icons circle blue valign">repeat</i>
                  <span class="title">
                    The device needs to be able to run without battery replacement for at least 1 year, preferably 2.
                  </span>
              </li>
              <li class="collection-item avatar valign-wrapper">
                  <i class="material-icons circle blue valign">assessment</i>
                  <span class="title">
                    The device should be at least 80% accurate in determining the occupancy of a room.
                  </span>
              </li>
              <li class="collection-item avatar valign-wrapper">
                  <i class="material-icons circle blue valign">shopping_cart</i>
                  <span class="title">
                    The device should have a manufacturing cost of no more than $90 at scale.
                  </span>
              </li>
              <li class="collection-item avatar valign-wrapper">
                  <i class="material-icons circle blue valign">search</i>
                  <span class="title">
                    The user interface should allow users to easily add/remove devices and identify the device's approximate location.
                  </span>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <!-- Specifications -->
    <div class="section grey lighten-2">
      <div class="container">
        <div class="row">
          <div class="col s12">
            <div id="specifications" class="center-align scrollspy">
              <h1>Technical Specifications</h1>
            </div>
            <div class="section">
              <h3>Hardware Components</h3>
              <table class="striped">
                <thead>
                  <tr>
                    <th>Part Name</th>
                    <th>Details</th>
                    <th>Vendor</th>
                    <th>Cost</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Atmel SAM L21E</td>
                    <td>Ultra low-power 32-bit microcontroller. 256KB Flash, 30KB SRAM, 48 MHz clock speed.</td>
                    <td><a href="http://www.digikey.com/product-detail/en/microchip-technology/ATSAML21E18B-MUT/ATSAML21E18B-MUTCT-ND/5702303">Digikey</a></td>
                    <td>$4.64</td>
                  </tr>
                  <tr>
                    <td>Microchip RN2903</td>
                    <td>LoRaWAN module, controllable over UART. Contains its own small MCU.</td>
                    <td><a href="http://www.digikey.com/product-detail/en/microchip-technology/RN2903-I-RM095/RN2903-I-RM095-ND/5810537">Digikey</a></td>
                    <td>$14.70</td>
                  </tr>
                  <tr>
                    <td>916MHZ Antennae</td>
                    <td>Antenna for use with the LoRaWAN module.</td>
                    <td><a href="http://www.digikey.com/product-detail/en/linx-technologies-inc/ANT-916-CW-HWR-SMA/ANT-916-CW-HWR-SMA-ND/1139580">Digikey</a></td>
                    <td>$10.39</td>
                  </tr>
                  <tr>
                    <td>Grid-Eye Infrared Sensor</td>
                    <td>Low-power grid of sensors that generates an 8x8 IR image. Capable of sampling up to 10 Hz</td>
                    <td><a href="http://www.digikey.com/product-detail/en/panasonic-electronic-components/AMG8833/P19002CT-ND/5825306">Digikey</a></td>
                    <td>$22.16</td>
                  </tr>
                  <tr>
                    <td>Panasonic IR sensor</td>
                    <td>Low-power passive IR motion detector</td>
                    <td><a href="http://www.mouser.com/ProductDetail/Panasonic-Industrial-Devices/EKMB1201112/?qs=raAh8RbVwI4LuRSPX3ZDrw%3D%3D">Mouser</a></td>
                    <td>$19.79</td>
                  </tr>
                  <tr>
                    <td>Switching Transistor</td>
                    <td>Low resistance transistor to switch power to sensors</td>
                    <td><a href="http://www.mouser.com/ProductDetail/Diodes-Incorporated/DMP3010LK3-13/?qs=gfe7vQ8txpVgVF8Xq4P2IQ%3D%3D">Mouser</a></td>
                    <td>$0.61</td>
                  </tr>
                  <tr>
                    <td>Assorted SMD resistors & capacitors</td>
                    <td>Various filtering caps and pull-up resistors</td>
                    <td>Mouser/ Digikey</td>
                    <td>~$2.00</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="divider"></div>
            <div class="section">
              <h3>Software Components</h3>
              <table class="striped">
                <thead>
                  <tr>
                    <th>Component Name</th>
                    <th>Description</th>
                    <th>Vendor</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Django Web Framework</td>
                    <td>The Django framework will be used to implement the cloud service API that will receive data from the LoRaWAN network and serve it to our front-end interface. We will be using Python 3.6 and Django 1.10</td>
                    <td><a href="https://www.djangoproject.com">Django Software Foundation</a></td>
                  </tr>
                  <tr>
                    <td>React</td>
                    <td>The React library will be used to create a dynamic front-end user interface.</td>
                    <td><a href="https://facebook.github.io/react/">Facebook Open Source</a></td>
                  </tr>
                  <tr>
                    <td>Let's Encrypt</td>
                    <td>Let's Encrypt's certificate authority and software tools will be used to securely transmit data over SSL/TLS.</td>
                    <td><a href="https://letsencrypt.org/">Internet Security Research Group</a></td>
                  </tr>
                  <tr>
                    <td>Custom Atmel SAM Firmware</td>
                    <td>We will utilize Atmel software libraries and write C code to implement custom firmware on our device.</td>
                    <td><a href="http://www.microchip.com/wwwproducts/en/ATSAML21E18B">Microchip</a></td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="section">
              <h3>Protocols</h3>
              <table class="striped">
                <thead>
                  <tr>
                    <th>Protocol Name</th>
                    <th>Usage</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>LoRaWAN</td>
                    <td>Our device will transmit data through the LoRaWAN backbone to our internet service.</td>
                  </tr>
                  <tr>
                    <td>UART</td>
                    <td>Our SAM microcontroller will send commands to the LoRa module over UART.</td>
                  </tr>
                  <tr>
                    <td>I<sup>2</sup>C</td>
                    <td>
                      Our SAM microcontroller will send commands to and read data from the Grid-EYE sensor using I<sup>2</sup>C
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Use Cases -->
    <div class="section grey lighten-4">
      <div class="container">
        <div class="row">
          <div class="col s12">
            <div id="use-cases" class="center-align scrollspy">
              <h1>Use Cases</h1>
            </div>
          </div>
        </div>
        <div class="row valign-wrapper">
          <div class="col s12 m5">
            <img class="responsive-img" src="images/hvac_graph.png">
          </div>
          <div class="col s12 m5 offset-m2 valign">
            <img class="responsive-img" src="images/popular_graph.png">
          </div>
        </div>
        <div class="row">
          <div class="col s12 m5">
            <h2 class="center-align">Environmental control</h2>
            <p class="flow-text">
              If an organization can better understand where people are in a building, it can more effectively control the HVAC systems in order to manage energy consumption.
            </p>
          </div>
          <div class="col s12 m5 offset-m2">
            <h2 class="center-align">Real-time occupancy</h2>
            <p class="flow-text">
              If we know how many people are in a room/building, we can present that data to the public through a web interface. This could be used to determine whether a shared space like a library or workout space is too crowded.
            </p>
          </div>
        </div>
      </div>
    </div>
    <!-- Architecture -->
    <div class="section grey lighten-2">
      <div class="container">
        <div class="row">
          <div class="col s12 m10 offset-m1">
            <div id="architecture" class="center-align scrollspy">
              <h1>Architecture</h1>
              <img class="responsive-img" src="images/architecture.png">
              <p class="flow-text">
                This diagram gives a high level overview of the architecture of our sensor system. The "brain" is the Atmel SAM L21E microcontroller, a low-power chip that can drive each of our other components. When motion is detected by the PIR sensor, it will send an interrupt to the SAM chip in order to wake it up from deep sleep. The GridEye infrared camera generates an 8x8 grid of IR pixels at 10 frames per second, sent over I2C back to the microcontroller. All processing is done on-chip, so the only data transmitted through the RN2903 LoRa transceiver are the changes in occupancy.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Interactions -->
    <div class="section grey lighten-4">
      <div class="container">
        <div class="row">
          <div class="col s12">
            <div id="interactions" class="center-align scrollspy">
              <h1>Interactions</h1>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col s6">
            <h2>Sensor Wakeup</h2>
          </div>
        </div>
        <div class="row">
          <div class="col s12">
            <img class="responsive-img" src="images/sensor_interaction.png">
          </div>
          <div class="col s12">
            <p class="flow-text">
              This interaction diagram details the process of waking up the chip to detect a person entering/exiting a room. Most of the time, our MCU will be in a deep sleep running only the PIR sensor. Upon detecting motion in the area, the PIR device will trigger a wakeup for the MCU and then the Grideye. The microcontroller will then begin to sample the Grideye data at 10 FPS, interpreting the 8x8 heatmap as a number of people entering-exiting. Once motion has subsided, the chip will return to the deep sleep state.
            </p>
          </div>
        </div>
        <div class="row">
          <div class="col s6">
            <h2>Data Flow</h2>
          </div>
        </div>
        <div class="row">
          <div class="col s12 m12">
            <img class="responsive-img" src="images/data_interaction.png">
          </div>
          <div class="col s12 m12">
            <p class="flow-text">
              The data flow interaction diagram is fairly self-explanatory. The MCU will wakeup on a configurable interval and transmit the change in occupancy it has seen since the last transmission. Sending essentially 1 byte allows us to minimize the transmission time and reduce power consumption.
            </p>
            <p class="flow-text">
              The LoRaWAN infrastructure set up by the <a href="http://wise.ece.cmu.edu/">CMU WiSE Lab</a> exposes data sent by clients through an MQTT service. We run a daemon client on our webserver that will automatically subscribe to the data queues of each device setup with our service. Upon receipt of a sensor update, the server persists the change to the database and updates related values.
            </p>
          </div>
        </div>
      </div>
    </div>
    <!-- Progress -->
    <div class="section grey lighten-2">
      <div class="container">
        <div class="row">
          <div class="col s12">
            <div id="progress" class="center-align scrollspy">
              <h1>Progress</h1>
            </div>
          </div>
        </div>
        <div class="section">
          <div class="row">
            <div class="col s12 m6 offset-m6">
              <h2>February 28, 2017</h2>
            </div>
          </div>
          <div class="row">
            <div class="col s12 m6">
              <img class="responsive-img" src="images/grideye.gif">
            </div>
            <div class="col s12 m6">
              <p class="flow-text">
                After carefully soldering wires onto the tiny SMD pads of the Grid-EYE, we were able to communicate with the device over I2C and capture some live data. The gif to the left shows one person walking back and forth under the sensor while it was held 8 feet off of the ground.
              </p>
              <p class="flow-text">
                This is a promising start - we're now confident that we can determine direction as well as differentiate between multiple people entering/exiting at the same time.
              </p>
            </div>
          </div>
        </div>
        <div class="divider"></div>
        <div class="section">
          <div class="row">
            <div class="col s12 m6">
              <h2>March 1, 2017</h2>
            </div>
          </div>
          <div class="row">
            <div class="col s12 m6">
              <p class="flow-text">
                In the interest of rapid prototyping, we designed small breakout boards for each of our three major devices: the PIR motion detector, the Grid-EYE, and the RN2903 LoRaWAN module. The boards will be panelized so that we can break them apart and position them individually.
              </p>
              <p class="flow-text">
                Each board is the simplest possible circuit to control the device, with control/output pins routed to GPIO headers. Each board also needs to be supplied separate power and ground.
              </p>
            </div>
            <div class="col s12 m6">
              <img class="responsive-img" src="images/breakout.png">
            </div>
          </div>
        </div>
        <div class="divider"></div>
        <div class="section">
          <div class="row">
            <div class="col s12 m6 offset-m6">
              <h2>March 18, 2017</h2>
            </div>
          </div>
          <div class="row">
            <div class="col s12 m6">
              <img class="responsive-img" src="images/mqtt-code.png">
            </div>
            <div class="col s12 m6">
              <p class="flow-text">
                Driving the RN2903 module from a Particle Photon we successfully connected to the LoRaWAN network and were able to publish data messages. 
              </p>
              <p class="flow-text">
                We also implemented an MQTT daemon process on our webserver that subscribes to the RX queue, receives messages from our device, and updates the database. These updates are shown in real time in a simple React-based frontend interface.
              </p>
            </div>
          </div>
        </div>
        <div class="divider"></div>
        <div class="section">
          <div class="row">
            <div class="col s12 m6">
              <h2>March 22, 2017</h2>
            </div>
          </div>
          <div class="row">
            <div class="col s12 m6">
              <p class="flow-text">
                A long wait for parts delayed the final breakout boards, but we were finally able to complete each pcb with parts. Each component works as intended, and the small boards allow us to easily test multiple configurations.
              </p>
            </div>
            <div class="col s12 m6">
              <img class="responsive-img" src="images/breakout-pcbs.jpg">
            </div>
          </div>
        </div>
        <div class="divider"></div>
        <div class="section">
          <div class="row">
            <div class="col s12 m6 offset-m6">
              <h2>March 31, 2017</h2>
            </div>
          </div>
          <div class="row">
            <div class="col s12 m6">
              <img class="responsive-img" src="images/final_pcb.png">
            </div>
            <div class="col s12 m6">
              <p class="flow-text">
                Pictured here is our semi-final PCB design, integrating the SAM L21E MCU and the RN2903/GridEye breakouts. As with the previous print, these are 3 separate boards panelized together into the same print job. The RN2903 and GridEye breakouts are essentially the same, with the only functional change being the addition of large ground planes and through-hole vias in order to provide shielding for the RF components of the LoRa module.
              </p>
              <p class="flow-text">
                The control board features the SAM L21E microcontroller and headers to connect each of the different sensor components by wire. We chose to keep the sensors on separate boards to allow for easy placement and configuration in our final housing. A key feature is that we do not route the 3.3V power lines directly to the headers - instead, power to each breakout module is controlled by a switching transistor through the MCU. This allows us to completely shut off power to all components.
              </p>
            </div>
          </div>
        </div>
        <div class="divider"></div>
        <div class="section">
          <div class="row">
            <div class="col s12 m6">
              <h2>April 14, 2017</h2>
            </div>
          </div>
          <div class="row">
            <div class="col s12 m6">
              <p class="flow-text">
                We finally got around to designing a case for our product! It's a rough print and certainly a draft design, but is able to houses all of our components and mount above a door frame. Additionally, we've integrated the full processing pipeline: from getting GridEYE frames to sending counts via LoRaWAN. The software for counting still needs to be tweaked for people counting and sleep2wake via the PIR sensor.
              </p>
              <p class="flow-text">
                We're currently in the process of fixing the PCB design from last update to account for the small errors we made. A slimmer case is also in the works to give all the components a more snug fit and also add slots for a battery pack, indicator LED and power switch.
              </p>
            </div>
            <div class="col s12 m6">
              <img class="responsive-img" src="images/occulow_integration2.jpg">
              <img class="responsive-img" src="images/occulow_integration.jpg">
            </div>
          </div>
        </div>
      </div>
      </div>
    </div>
    <!-- About -->
    <div class="section grey lighten-4">
      <div class="container">
        <div class="row">
          <div class="col s12">
            <div id="about" class="center-align scrollspy">
              <h1>About Us</h1>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col s12 m3">
            <img class="responsive-img" src="images/terence-pic.jpg">
          </div>
          <div class="col s12 m9">
            <h4>Terence Sun</h4>
            <p class="flow-text">Terence is in charge of implementing the core firmware and sensor manager platform.</p>
          </div>
        </div>
        <div class="row">
          <div class="col s12 m3">
            <img class="responsive-img" src="images/jacob-pic.png">
          </div>
          <div class="col s12 m9">
            <h4>Jacob Brooks</h4>
            <p class="flow-text">Jacob is the PCB engineer as well as the cloud service lead.</p>
          </div>
        </div>
        <div class="row">
          <div class="col s12 m3">
            <img class="responsive-img" src="images/udaya-pic.jpg">
          </div>
          <div class="col s12 m9">
            <h4>Udaya Malik</h4>
            <p class="flow-text">Udaya is responsible for implementing the people-counting algorithm and the Grideye driver.</p>
          </div>
        </div>
        <div class="row">
          <div class="col s12 m3">
            <img class="responsive-img" src="images/preetam-pic.jpg">
          </div>
          <div class="col s12 m9">
            <h4>Preetam Amancharla</h4>
            <p class="flow-text">Preetam is managing the implementation of the LoRa firmware driver as well as providing assistance and QA for the sensor analysis.</p>
          </div>
        </div>
        <div class="divider"></div>
      </div>
    </div>
    <!--Import jQuery before materialize.js-->
    <script type="text/javascript" src="js/jquery-3.1.1.min.js"></script>
    <script type="text/javascript" src="js/materialize.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function(){
        $(".button-collapse").sideNav({
          menuWidth: 200,
          closeOnClick: true
        });

        $('.scrollspy').scrollSpy({scrollOffset: 100});
      });

    </script>
  </body>
</html>